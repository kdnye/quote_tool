<!doctype html>
<title>Email Quote Request</title>
{% with messages = get_flashed_messages() %}
  {% if messages %}
    <ul>
    {% for message in messages %}<li>{{ message }}</li>{% endfor %}
    </ul>
  {% endif %}
{% endwith %}

<h2>Email Quote Request (${{ '%.2f'|format(admin_fee) }} Admin Fee)</h2>
<p><strong>Quote ID:</strong> {{ quote.quote_id }}</p>
<p><strong>Origin:</strong> {{ quote.origin }} &nbsp; <strong>Destination:</strong> {{ quote.destination }} &nbsp; <strong>Weight:</strong> {{ quote.weight }}</p>

{% if acc_rows %}
<h3>Accessorials</h3>
<table border="1" cellpadding="4" cellspacing="0">
  <tr><th>Name</th><th>Price</th></tr>
  {% for name, price in acc_rows %}
    <tr><td>{{ name }}</td><td>${{ '%.2f'|format(price) }}</td></tr>
  {% endfor %}
  <tr><td><strong>Subtotal:</strong></td><td>${{ '%.2f'|format(acc_subtotal) }}</td></tr>
  {% if guarantee_selected %}
    <tr><td>Guarantee (25%)</td><td>${{ '%.2f'|format(guarantee_amount) }}</td></tr>
    <tr><td><strong>Accessorials + Guarantee Subtotal:</strong></td><td>${{ '%.2f'|format(acc_plus_guarantee_subtotal) }}</td></tr>
  {% endif %}
</table>
{% endif %}

<p>Email processing adds a ${{ '%.2f'|format(admin_fee) }} admin fee. The 'Book Quote' button does not include this fee.</p>
<p><strong>Quote Total:</strong> ${{ '%.2f'|format(email_total) }} (includes admin fee)</p>

<form method="post">
  <fieldset>
    <legend>Shipper Information</legend>
    <label>Name <input type="text" name="shipper_name"></label><br>
    <label>Address <input type="text" name="shipper_address" value="{{ quote.origin }}"></label><br>
    <label>Contact <input type="text" name="shipper_contact"></label><br>
    <label>Phone <input type="text" name="shipper_phone"></label><br>
  </fieldset>
  <fieldset>
    <legend>Consignee Information</legend>
    <label>Name <input type="text" name="consignee_name"></label><br>
    <label>Address <input type="text" name="consignee_address" value="{{ quote.destination }}"></label><br>
    <label>Contact <input type="text" name="consignee_contact"></label><br>
    <label>Phone <input type="text" name="consignee_phone"></label><br>
  </fieldset>
  <label>Total Weight <input type="number" step="0.01" name="total_weight" value="{{ quote.weight }}"></label><br>
  <label>Special Instructions <textarea name="special_instructions">{{ selected_accessorials|join(', ') }}</textarea></label><br>
  <button type="submit">Submit</button>
</form>

<a href="{{ url_for('quote.quote') }}">Back to Quote</a>
